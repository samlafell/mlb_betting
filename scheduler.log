/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/.venv/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/.venv/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'allow_population_by_field_name' has been renamed to 'validate_by_name'
  warnings.warn(message, UserWarning)
üèà MLB Betting Analysis Scheduler
==================================================
2025-06-18 17:09:01 [info     ] Starting MLB betting scheduler service=scheduler
2025-06-18 17:09:01 [info     ] Scheduler started successfully jobs_count=2 service=scheduler
üöÄ Scheduler started successfully!

üìã Schedule:
   üïê Hourly data collection: Every hour at :00
   üåÖ Daily setup: 6:00 AM EST (gets today's games)
   ‚öæ Game alerts: 5 minutes before each game

üí° Notifications will appear in this console
   You can also integrate with Slack/Discord/email later

üéØ Your betting analysis will run:
   ‚Ä¢ Every hour for general updates
   ‚Ä¢ 5 minutes before each game for real-time analysis

Press Ctrl+C to stop the scheduler...
==================================================

üìä Initial Status: 2 jobs scheduled
2025-06-18 17:09:01 [info     ] Fetching MLB games             date=2025-06-18 service=mlb_stats_api
2025-06-18 17:09:01 [info     ] Successfully fetched MLB games date=2025-06-18 games_count=15 service=mlb_stats_api
2025-06-18 17:09:01 [info     ] Scheduled game alert           alert_time=datetime.datetime(2025, 6, 18, 22, 35, tzinfo=datetime.timezone.utc) game='Philadelphia Phillies @ Miami Marlins' game_time=datetime.datetime(2025, 6, 18, 22, 40, tzinfo=datetime.timezone.utc) service=scheduler
2025-06-18 17:09:01 [info     ] Scheduled game alert           alert_time=datetime.datetime(2025, 6, 18, 22, 40, tzinfo=datetime.timezone.utc) game='Colorado Rockies @ Washington Nationals' game_time=datetime.datetime(2025, 6, 18, 22, 45, tzinfo=datetime.timezone.utc) service=scheduler
2025-06-18 17:09:01 [info     ] Scheduled game alert           alert_time=datetime.datetime(2025, 6, 18, 23, 0, tzinfo=datetime.timezone.utc) game='Los Angeles Angels @ New York Yankees' game_time=datetime.datetime(2025, 6, 18, 23, 5, tzinfo=datetime.timezone.utc) service=scheduler
2025-06-18 17:09:01 [info     ] Scheduled game alert           alert_time=datetime.datetime(2025, 6, 18, 23, 2, tzinfo=datetime.timezone.utc) game='Arizona Diamondbacks @ Toronto Blue Jays' game_time=datetime.datetime(2025, 6, 18, 23, 7, tzinfo=datetime.timezone.utc) service=scheduler
2025-06-18 17:09:01 [info     ] Scheduled game alert           alert_time=datetime.datetime(2025, 6, 18, 23, 5, tzinfo=datetime.timezone.utc) game='Minnesota Twins @ Cincinnati Reds' game_time=datetime.datetime(2025, 6, 18, 23, 10, tzinfo=datetime.timezone.utc) service=scheduler
2025-06-18 17:09:01 [info     ] Scheduled game alert           alert_time=datetime.datetime(2025, 6, 18, 23, 10, tzinfo=datetime.timezone.utc) game='New York Mets @ Atlanta Braves' game_time=datetime.datetime(2025, 6, 18, 23, 15, tzinfo=datetime.timezone.utc) service=scheduler
2025-06-18 17:09:01 [info     ] Scheduled game alert           alert_time=datetime.datetime(2025, 6, 18, 23, 30, tzinfo=datetime.timezone.utc) game='Baltimore Orioles @ Tampa Bay Rays' game_time=datetime.datetime(2025, 6, 18, 23, 35, tzinfo=datetime.timezone.utc) service=scheduler
2025-06-18 17:09:01 [info     ] Scheduled game alert           alert_time=datetime.datetime(2025, 6, 18, 23, 35, tzinfo=datetime.timezone.utc) game='St. Louis Cardinals @ Chicago White Sox' game_time=datetime.datetime(2025, 6, 18, 23, 40, tzinfo=datetime.timezone.utc) service=scheduler
2025-06-18 17:09:01 [info     ] Scheduled game alert           alert_time=datetime.datetime(2025, 6, 19, 0, 0, tzinfo=datetime.timezone.utc) game='Kansas City Royals @ Texas Rangers' game_time=datetime.datetime(2025, 6, 19, 0, 5, tzinfo=datetime.timezone.utc) service=scheduler
2025-06-18 17:09:01 [info     ] Scheduled game alert           alert_time=datetime.datetime(2025, 6, 19, 0, 0, tzinfo=datetime.timezone.utc) game='Milwaukee Brewers @ Chicago Cubs' game_time=datetime.datetime(2025, 6, 19, 0, 5, tzinfo=datetime.timezone.utc) service=scheduler
2025-06-18 17:09:01 [info     ] Scheduled game alert           alert_time=datetime.datetime(2025, 6, 19, 1, 40, tzinfo=datetime.timezone.utc) game='Cleveland Guardians @ San Francisco Giants' game_time=datetime.datetime(2025, 6, 19, 1, 45, tzinfo=datetime.timezone.utc) service=scheduler
2025-06-18 17:09:01 [info     ] Scheduled game alert           alert_time=datetime.datetime(2025, 6, 19, 2, 0, tzinfo=datetime.timezone.utc) game='Houston Astros @ Athletics' game_time=datetime.datetime(2025, 6, 19, 2, 5, tzinfo=datetime.timezone.utc) service=scheduler
2025-06-18 17:09:01 [info     ] Scheduled game alert           alert_time=datetime.datetime(2025, 6, 19, 2, 5, tzinfo=datetime.timezone.utc) game='San Diego Padres @ Los Angeles Dodgers' game_time=datetime.datetime(2025, 6, 19, 2, 10, tzinfo=datetime.timezone.utc) service=scheduler
2025-06-18 17:09:01 [info     ] Game alerts scheduled for today alerts_scheduled=13 games_found=15 service=scheduler

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 0
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Hourly Data Collection: 2025-06-18 18:00:00-04:00
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 0
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Hourly Data Collection: 2025-06-18 18:00:00-04:00
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 0
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Hourly Data Collection: 2025-06-18 18:00:00-04:00
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 0
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Hourly Data Collection: 2025-06-18 18:00:00-04:00
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 0
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Hourly Data Collection: 2025-06-18 18:00:00-04:00
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 0
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Hourly Data Collection: 2025-06-18 18:00:00-04:00
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 0
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Hourly Data Collection: 2025-06-18 18:00:00-04:00
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 0
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Hourly Data Collection: 2025-06-18 18:00:00-04:00
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 0
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Hourly Data Collection: 2025-06-18 18:00:00-04:00
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 0
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Hourly Data Collection: 2025-06-18 18:00:00-04:00
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00
2025-06-18 18:00:00 [info     ] Executing hourly data collection service=scheduler
2025-06-18 18:00:00 [info     ] Starting entrypoint execution  context=hourly service=scheduler
2025-06-18 18:00:17 [info     ] Entrypoint executed successfully context=hourly execution_time=17.517507 service=scheduler stdout_lines=38
2025-06-18 18:00:17 [info     ] Hourly execution completed successfully execution_time=17.517507 service=scheduler

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 1
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00
     - Game Alert: Los Angeles Angels @ New York Yankees: 2025-06-18 23:00:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 1
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00
     - Game Alert: Los Angeles Angels @ New York Yankees: 2025-06-18 23:00:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 1
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00
     - Game Alert: Los Angeles Angels @ New York Yankees: 2025-06-18 23:00:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 1
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00
     - Game Alert: Los Angeles Angels @ New York Yankees: 2025-06-18 23:00:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 1
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00
     - Game Alert: Los Angeles Angels @ New York Yankees: 2025-06-18 23:00:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 1
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00
     - Game Alert: Los Angeles Angels @ New York Yankees: 2025-06-18 23:00:00+00:00

üìä Status Update:
   ‚Ä¢ Jobs active: 15
   ‚Ä¢ Hourly runs completed: 1
   ‚Ä¢ Game alerts sent: 0
   ‚Ä¢ Errors: 0
   ‚Ä¢ Games scheduled today: 13
   ‚Ä¢ Next jobs:
     - Game Alert: Philadelphia Phillies @ Miami Marlins: 2025-06-18 22:35:00+00:00
     - Game Alert: Colorado Rockies @ Washington Nationals: 2025-06-18 22:40:00+00:00
     - Game Alert: Los Angeles Angels @ New York Yankees: 2025-06-18 23:00:00+00:00
2025-06-18 18:35:00 [info     ] Triggering game alert          game='Philadelphia Phillies @ Miami Marlins' service=scheduler
2025-06-18 18:35:00 [info     ] NOTIFICATION                   context=game_alert message='üèà GAME ALERT: Philadelphia Phillies @ Miami Marlins starts in 5 minutes! Running analysis...' service=scheduler

üö® [2025-06-18 18:35:00] GAME_ALERT: üèà GAME ALERT: Philadelphia Phillies @ Miami Marlins starts in 5 minutes! Running analysis...

2025-06-18 18:35:00 [info     ] Starting entrypoint execution  context=game_alert service=scheduler
2025-06-18 18:35:00 [error    ] Entrypoint execution failed    context=game_alert returncode=1 service=scheduler stderr='/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/.venv/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:\n* \'schema_extra\' has been renamed to \'json_schema_extra\'\n  warnings.warn(message, UserWarning)\n/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/.venv/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:\n* \'allow_population_by_field_name\' has been renamed to \'validate_by_name\'\n  warnings.warn(message, UserWarning)\n[\x1b[31m\x1b[1merror    \x1b[0m] \x1b[1mFailed to initialize DuckDB connection\x1b[0m [\x1b[0m\x1b[1m\x1b[34mmlb_sharp_betting.db.connection\x1b[0m]\x1b[0m \x1b[36merror\x1b[0m=\x1b[35m\'IO Error: Could not set lock on file "/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/data/raw/mlb_betting.duckdb": Conflicting lock is held in /Users/samlafell/.pyenv/versions/3.10.13/bin/python3.10 (PID 57562) by user samlafell. See also https://duckdb.org/docs/stable/connect/concurrency\'\x1b[0m\nTraceback (most recent call last):\n  File "/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/src/mlb_sharp_betting/db/connection.py", line 80, in _init_connection\n    self._connection = duckdb.connect(\nduckdb.duckdb.IOException: IO Error: Could not set lock on file "/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/data/raw/mlb_betting.duckdb": Conflicting lock is held in /Users/samlafell/.pyenv/versions/3.10.13/bin/python3.10 (PID 57562) by user samlafell. See also https://duckdb.org/docs/stable/connect/concurrency\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/src/mlb_sharp_betting/entrypoint.py", line 466, in <module>\n    asyncio.run(main()) \n  File "/Users/samlafell/.pyenv/versions/3.10.13/lib/python3.10/asyncio/runners.py", line 44, in run\n    return loop.run_until_complete(main)\n  File "/Users/samlafell/.pyenv/versions/3.10.13/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete\n    return future.result()\n  File "/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/src/mlb_sharp_betting/entrypoint.py", line 450, in main\n    pipeline = DataPipeline(\n  File "/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/src/mlb_sharp_betting/entrypoint.py", line 77, in __init__\n    self.db_manager = get_db_manager()\n  File "/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/src/mlb_sharp_betting/db/connection.py", line 399, in get_db_manager\n    return DatabaseManager()\n  File "/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/src/mlb_sharp_betting/db/connection.py", line 55, in __init__\n    self._init_connection()\n  File "/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/src/mlb_sharp_betting/db/connection.py", line 90, in _init_connection\n    raise DatabaseConnectionError(f"Failed to initialize connection: {e}")\nmlb_sharp_betting.core.exceptions.DatabaseConnectionError: Failed to initialize connection: IO Error: Could not set lock on file "/Users/samlafell/Documents/programming_projects/sports_betting_dime_splits/data/raw/mlb_betting.duckdb": Conflicting lock is held in /Users/samlafell/.pyenv/versions/3.10.13/bin/python3.10 (PID 57562) by user samlafell. See also https://duckdb.org/docs/stable/connect/concurrency\n'
2025-06-18 18:35:00 [info     ] NOTIFICATION                   context=game_alert_error message='‚ùå Analysis failed for Philadelphia Phillies @ Miami Marlins! Error: Exit code 1' service=scheduler

üö® [2025-06-18 18:35:00] GAME_ALERT_ERROR: ‚ùå Analysis failed for Philadelphia Phillies @ Miami Marlins! Error: Exit code 1


üõë Received signal 15, shutting down gracefully...
2025-06-18 18:36:48 [info     ] Stopping scheduler             service=scheduler
‚úÖ Scheduler stopped. Goodbye!
